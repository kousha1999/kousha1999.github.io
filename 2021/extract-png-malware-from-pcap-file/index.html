<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title> :: Hugo Theme Tailwind Example Site - Example site for hugo-theme-tailwind</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Extract PNG Malware from PCAP File I want to talk about How I detected and extracted PNG malware from a PCAP file.
What we will cover in this post:
Introduction to Packet Analysis Introduction to Wireshark Detect Malicious Network Traffic Partial Content Responses Impact of Connection Problems Extract Malicious File from HTTP for analysis and Reverse Engineering Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:
"
/>
<meta
  name="keywords"
  content="hugo, tailwind, tailwindcss, hugo theme, hugo theme tailwind"
/>
<meta name="robots" content="noodp" /><link rel="manifest" href="/manifest.json" /><meta property="og:url" content="http://localhost:1313/2021/extract-png-malware-from-pcap-file/">
  <meta property="og:site_name" content="Hugo Theme Tailwind Example Site">
  <meta property="og:title" content="Hugo Theme Tailwind Example Site">
  <meta property="og:description" content="Extract PNG Malware from PCAP File I want to talk about How I detected and extracted PNG malware from a PCAP file.
What we will cover in this post:
Introduction to Packet Analysis Introduction to Wireshark Detect Malicious Network Traffic Partial Content Responses Impact of Connection Problems Extract Malicious File from HTTP for analysis and Reverse Engineering Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="2021">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hugo Theme Tailwind Example Site">
  <meta name="twitter:description" content="Extract PNG Malware from PCAP File I want to talk about How I detected and extracted PNG malware from a PCAP file.
What we will cover in this post:
Introduction to Packet Analysis Introduction to Wireshark Detect Malicious Network Traffic Partial Content Responses Impact of Connection Problems Extract Malicious File from HTTP for analysis and Reverse Engineering Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:">


<link rel="canonical" href="http://localhost:1313/2021/extract-png-malware-from-pcap-file/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.f2b5b9c8e4e9b03048601ca9eedc29df44c3a73343f4538f41785e16f13c341a.css">









  
  

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/logo.webp" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/posts" title="Post">Post</a>
        </li>
      
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="/about" title="About">About</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/2021/extract-png-malware-from-pcap-file/">
        
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/2021/extract-png-malware-from-pcap-file/"></a>
      </h1>

      
      


      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      6 minutes to read
    </span>
  </div>
</div>

      

      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#extract-png-malware-from-pcap-file">Extract PNG Malware from PCAP File</a></li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <h2 id="extract-png-malware-from-pcap-file">Extract PNG Malware from PCAP File</h2>
<p>I want to talk about How I detected and extracted PNG malware from a PCAP file.</p>
<p>What we will cover in this post:</p>
<ul>
<li>Introduction to Packet Analysis</li>
<li>Introduction to Wireshark</li>
<li>Detect Malicious Network Traffic</li>
<li>Partial Content Responses</li>
<li>Impact of Connection Problems</li>
<li>Extract Malicious File from HTTP for analysis and Reverse Engineering</li>
</ul>
<p>Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:</p>
<ul>
<li>Trojan</li>
<li>Worms</li>
<li>Viruses</li>
<li>etc.</li>
</ul>
<p>A malware communicates with different domains and IP addresses for various reasons (e.g. Connect to <a href="https://www.trendmicro.com/vinfo/us/security/definition/command-and-control-server" target="_blank" rel="noopener">C&amp;C</a>
, Download the <a href="https://www.f-secure.com/v-descs/trojan-downloader.shtml" target="_blank" rel="noopener">Real Malware</a>
, etc.). One of the steps of <strong>Malware Analysis</strong> is to examine these network connections.</p>
<p>We can analyze Malware network communications with different methods and tools, We can use some tools such as <a href="https://sourceforge.net/projects/fakenet" target="_blank" rel="noopener">FakeNet</a>
 or <a href="https://www.inetsim.org" target="_blank" rel="noopener">iNetSim</a>
 to simulate and analyze outgoing connections, also we can analyze the captured network packets such as <code>.pcap</code> file, which can be analyzed by <a href="https://www.wireshark.org" target="_blank" rel="noopener">Wireshark</a>
.</p>
<p>Wireshark is a free and open-source packet analyzer. It is used for network troubleshooting, analysis, software and communications protocol development, and education.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/113446492-1e5f9b80-940d-11eb-9601-103b9a765d13.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>

<em>Wireshark Application</em></p>
<p>Wireshark contains 3 windows, the top window (with the green bg colour) whose name is  Packet List, the middle one (called the &ldquo;Packet Details&rdquo; window) and the bottom one (the &ldquo;Packet Bytes&rdquo; window).</p>
<ul>
<li>Packet List: Displays packets sent in a network interface.</li>
<li>Packet Details: Displays the information and headers of a sent packet in details.</li>
<li>Packet Bytes: This section displays the contents of a sent package in HEX and ASCII.</li>
</ul>
<p>I want to analyze malicious network communication (for a malware) from the PCAP file in this post. First, we&rsquo;re going to open PCAP file (malware.pcap) in Wireshark, to do this, Select <code>File -&gt; Open</code> from the menu bar. (or simply use Ctrl + O shortcut key).</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/113447819-de4de800-940f-11eb-9746-17df0235c659.png"
      alt="2021-04-01_20-04" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>When you Open a PCAP file, depends on the system resources and PCAP size, it can take seconds or minutes to open.</p>
<p>It seems there are lots of packets in the PCAP file.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/113448970-15bd9400-9412-11eb-9bc1-c5e6fce9ccca.png"
      alt="2021-04-01_20-12" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Select <code>Statistics -&gt; Capture File Properties</code> from the menu bar (Shortcut: <code>Ctrl+Alt+Shift+C</code>) to see some information about PCAP file.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118025110-b2aa1000-b374-11eb-95a9-8e3cd07d35b3.png"
      alt="5" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>In the opened window, we can see how many packets captured and as already we guessed there is 931 packet.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118025674-58f61580-b375-11eb-8d1e-8940587c132c.png"
      alt="6-1024x626" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Now we must make a list of endpoints in the captured packets. to do this just select <code>Statistics -&gt; Endpoints</code> from the menu bar.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118026034-a2defb80-b375-11eb-9164-2eebfe3ff4a6.png"
      alt="7" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Now we can see endpoints, easy right?!</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118026107-b722f880-b375-11eb-8e4d-9c354b59cf34.png"
      alt="8" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>What we have learned so far is that, there are so many endpoints and also we have 931 packets. Now we should determine what kind of connections do we have.
To do this select <code>Statistics -&gt; Protocol Hierarchy</code> from menu bar.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118026627-4203f300-b376-11eb-8d3c-90a73b9dcd85.png"
      alt="9" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>It seems most of the requests were DNS requests or HTTP requests.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118027186-e423db00-b376-11eb-8bff-c347dfd80be1.png"
      alt="10-1024x241" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>We will now start reviewing some of the packets sent. As you can see in the top image, there are some media types connections. If we look at captured packets in-depth, we can find a word (.doc) document and an image with <strong>PNG</strong> extension.</p>
<blockquote>
<p>Note</p>
<p>Malwares use different type of techniques to avoid detection by monitoring systems.
One of these techniques is downloading a malicious file by a trojan with png, pdf, etc. file format.</p>
</blockquote>
<p>The below image shows sent packets to download <strong>78654543.png</strong> file. The first <code>HEAD</code> request is to ensure the file exists and then download of the image is started.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118029171-23532b80-b379-11eb-95b3-c5a404d9ba42.png"
      alt="11" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>But WAIT! The response type from the server is <code>206 Partial Content</code>! This status means that the file has a large size and the server divided it into small pieces (Segmentation) and send them. Right-click on one of the <strong>PNG</strong> requests and then select <code>Follow -&gt; HTTP Stream</code> (Shortcut: Ctrl+Alt+Shift+H) also you can choose <code>TCP Stream</code>, it doesn&rsquo;t make any difference here.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118034006-ba6eb200-b37e-11eb-9ffc-429bdb583f7d.png"
      alt="12" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Another window will open which contains requests packets to download the <strong>PNG</strong> file.
If you look at it carefully, you will see a suspicious thing, <strong>PNG</strong> is a Windows executable file. You can detect it with a file header &ldquo;<code>MZ</code>&rdquo;.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118034283-0de10000-b37f-11eb-8a10-c556e411dd6d.png"
      alt="14-1024x771" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>So this is a malicious request. We need to extract this file from captured requests to give it to malware analysts for in-depth analysis and reverse engineering to understand what does this malware. There are several ways to do it, One of the simple ways is to use <code>Export Objects</code>, Select <code>File -&gt; Export Objects -&gt; HTTP</code> from the menu bar.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118100169-62ba6000-b3eb-11eb-9b02-8a709ecbe2df.png"
      alt="15" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>The following window will open and the sent and received files by HTTP Protocol will be visible.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118110784-16c1e800-b3f8-11eb-8169-d3c40b917639.png"
      alt="16" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>As you can see cause of the <code>Partial Content</code> response type, files are divided into multiple parts. The Files can be downloaded and merged, to download and save the files click on each part and select the <code>Save</code> button.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118111182-9780e400-b3f8-11eb-8fb8-309ba7ce8eab.png"
      alt="17-1024x631" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>It seems part 4 had some trouble and it&rsquo;s corrupted. I&rsquo;m sure because in <code>TCP Stream</code> the fourth request is 12089 bytes but the fourth request in the top image is 24 KB.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118115957-dfa30500-b3fe-11eb-8222-a1bd3105ab55.png"
      alt="18-1024x955" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>If we check the <code>Partial Content</code> requests, We will see there is a problem in the fourth request and cause of TCP nature file downloaded twice.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118116789-f6962700-b3ff-11eb-8a51-a1532b28759f.png"
      alt="19-1024x312" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>To ensure that select <code>Statistics -&gt; I/O Graphs</code> and you will see TCP errors.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117010-45dc5780-b400-11eb-93f0-96dc96f0d400.png"
      alt="20" 
      loading="lazy"
    >
  </figure></div>

<div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117047-4d036580-b400-11eb-89d2-9cc0fd3ce72a.png"
      alt="21" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>it seems Wireshark can&rsquo;t detect these issues and fix errors, Then we need a way to fix this problem. Let&rsquo;s Use Google/DuckDuckGo.</p>
<p>One of the result in google is a SANS paper which introduce ChaosReader.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117229-95bb1e80-b400-11eb-8589-064361fa8d7a.png"
      alt="22" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>One of the result in google is a SANS paper which introduces ChaosReader.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117300-b4211a00-b400-11eb-9321-d9d89f65d5c2.png"
      alt="23-1024x680" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>To try this tool, search it on google and download it.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117516-fc403c80-b400-11eb-8be8-fd3aef88c933.png"
      alt="24" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>This tool is written in <strong>Perl</strong> language. You will encounter an error while running the tool.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118117922-6eb11c80-b401-11eb-8821-6252f672362e.png"
      alt="25" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>The root of the problem is the version used. Open ChaosReader file in an editor (like <code>NeoVIM</code>) and go to line 265 and make it a comment.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118119068-0bc08500-b403-11eb-976a-ca010ca083f0.png"
      alt="26" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Save the file and run it again. this time run it with <code>--help</code> switch to see the help page?! :)</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118119247-52ae7a80-b403-11eb-96f4-5d6a934990ed.png"
      alt="27-1024x674" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>It seems the tool needs a switch to run the whole process on a PCAP file. First, create a directory and move the PCAP file and ChaosReader file to it (because the output of the ChaosReader process is in the current directory and it is mess output :)). Run the tool with <code>-e</code> switch and give it the PCAP file name. The tool creates some HTML, HEX, and other types of files.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118119615-e08a6580-b403-11eb-8802-862bd6618476.png"
      alt="28-1024x606" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>There is a file with <strong>index.html</strong> name in the directory of output, open it in browser (like Firefox, Chromium). According to the size and counts of the HTTP responses in a TCP session, we can guess the red box marked in the below image is for download Malicious <strong>PNG</strong> file. (You can use <strong>as_html</strong> or <strong>hex</strong> to see the content)</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118120351-fea49580-b404-11eb-9b8e-b2e906e3e424.png"
      alt="29-1024x780" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Now we can download files with the <code>.data</code> extension or copy them from the output directory and then merged them as a file with the <code>cat</code> command in GNU/Linux or BSD.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118120487-39a6c900-b405-11eb-98f2-529f173edf27.png"
      alt="30-1024x563" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Now the malware is ready with the <code>malware._exe</code> name. All we need now is to open it in a reverse engineering tool like <strong>Radare2</strong>,<strong>IDA Pro</strong>, or <strong>Ghidra</strong>, etc.</p>
<p><div class="not-prose">
<figure>
    <img src="https://user-images.githubusercontent.com/36133745/118120624-6ce95800-b405-11eb-9fbe-2e552846060d.png"
      alt="31-1024x567" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>The file seems OK and it&rsquo;s a PE file. If you check the strings of the file, we see it is developed by <strong>C++</strong> programming language. Now a malware analyst can reverse and analyze this. The rest of the process involves reverse engineering knowledge and malware analysis, and now a malware analyst can examine it.</p>

      </article>

      




    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
  
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2023 - 2024 Your Name
    
  </div>
  
  <div class="flex flex-row">
    <span class="ml-0 pl-0 md:ml-2 md:pl-2 border-l-0 md:border-l border-slate-300 dark:border-slate-400">
      Powered by <a href="https://gohugo.io" target="_blank" rel="noopener" class="underline">Hugo</a> <span class="text-red-600">&hearts;</span> <a href="https://github.com/tomowang/hugo-theme-tailwind" target="_blank" rel="noopener" class="underline">Tailwind</a>
    </span>
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>




</body>
</html>
