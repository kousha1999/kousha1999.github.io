## Extract PNG Malware from PCAP File

I want to talk about How I detected and extracted a PNG malware from a pcap file.
We will talk about:
- Introduction to Packet Analysis
- Introduction to Wireshark
- Detect Malicious Network Traffic
- Partial Content Responses
- Impact of Connection Problems
- Extract Malicious File from HTTP for analysis and Reverse Engineering

Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:
- Trojan
- Worms
- Viruses
- etc.

Malware communicates with different domains and IP addresses for various reasons (e.g. Connect to [C&C](https://www.trendmicro.com/vinfo/us/security/definition/command-and-control-server), Download the [Real Malware](https://www.f-secure.com/v-descs/trojan-downloader.shtml), etc.). One of the steps of **Malware Analysis** is to examine these network connections.

We can analyse Malware network communications with different methods and tools, We can use some tools such as [FakeNet](https://sourceforge.net/projects/fakenet) or [iNetSim](https://www.inetsim.org) to simulate and analyse outgoing connections, also we can analyse the captured network packets such as `.pcap` file, which can be analyse by [Wireshark](https://www.wireshark.org).

Wireshark is a free and open-source packet analyzer. It is used for network troubleshooting, analysis, software and communications protocol development, and education.

![](https://user-images.githubusercontent.com/36133745/113446492-1e5f9b80-940d-11eb-9601-103b9a765d13.png)
_Wireshark Application_

Wireshark contains 3 window, top window (green background color) which call **Packet List**, the middle one is Packet Details window and bottom window is Packet Bytes.
- Packet List: Displays packets sent in a network interface.
- Packet Details: Displays the information and headers of a sent packet in details.
- Packet Bytes: This section displays the contents of a sent package in HEX and ASCII.

I want to analyse malicious network communication (for a malware) from PCAP file in this post. First we're going to open PCAP file (malware.pcap) in Wireshark, to do this, Select `File -> Open` from menu bar. (or simply use Ctrl + O shortcut key).

![2021-04-01_20-04](https://user-images.githubusercontent.com/36133745/113447819-de4de800-940f-11eb-9746-17df0235c659.png)

When you Open a PCAP file, depends on the system resources and PCAP size, it can takes seconds to open.

It seems there are lots of packets in PCAP file.
![2021-04-01_20-12](https://user-images.githubusercontent.com/36133745/113448970-15bd9400-9412-11eb-9bc1-c5e6fce9ccca.png)

