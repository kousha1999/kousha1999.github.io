# Android Trust Wallet Stealer Malware Analysis

As far as technology improves, hackers do their best to abuse these technologies. Android became one of the most impressive technology and it's going further. Hackers research Android Security every moment and Android malware spread more and more. There is a lot of malware that developed till today. I want to analyze an Android malware that is a Crypto Wallet Stealer.

I have a sample which you can download it from [HERE](https://raw.githubusercontent.com/sk3ptre/AndroidMalware_2021/main/octCryptoStealer.zip). MD5 Checksum: 70b07a67b618a6352bf35a735645b156

<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164783235-d8df38a6-e0f3-4e68-9f64-57fa21b98435.gif">
</p>

I begin the analysis with Jadx. So first I open the malware with Jadx to analyze `AndroidManifest.xml`.

It seems malware does not have many activities, services, or even permissions. We have two activities and one service. Our Main Activity that starts first is the `SplashActivity`, then let's begin the analysis with that activity.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781757-d6257764-e837-45cd-821f-5bb7ca58f567.png">
</p>

In the `SplashActivity` there's just one thing, start a new Activity with a new thread.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781778-13242f06-6ebb-4c99-beca-52d64ca09644.png">
</p>

Let's go further and analyze MainActivity. Source code is easy to read, fortunately, We don't have to deal with obfuscation. :)
In `onCreate()` method we got just an if statement. Let's check the conditions.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781781-3b93b09d-a83d-475f-b929-54e91ccd72a8.png">
</p>


In `O()` method, the malware checks if the accessibility feature is already enabled, and also it will start the service that is defined in `AndroidManifest.xml`.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781790-9b4b88c8-948a-4360-afb8-fa588d1a1b80.png">
</p>

If accessibility feature does not enabled, malware execute `W()` function. `W()` function is the interesting part which using a phishing technique that trick the user to enable accessibility feature by himself. :)
The victim thinks that he confirms he's not a robot, but actually, he clicks on the Accessibility permission behind.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781792-020652e3-fc1a-4b8c-983a-3c7601f19fd8.png">
</p>

After all, malware again tries to check that if statement. However, this time `U()` function will execute. This function uses Trust Mobile Application Package (Wallet) as a Component and starts it. If this code block fails (Trust is not installed), it will execute `V()` function that shows a message to the user "This application is not compatible with your device!".
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781797-6a977447-aff0-491c-9284-0b4714809c64.png">
<img src="https://user-images.githubusercontent.com/36133745/164781801-394f8e1c-0342-4542-beca-b0ce59fe0f6c.png">
</p>

The `MyAccessibilityService` is quite interesting. This service clicks (touches) the buttons in the Trust application in the background by abusing the Accessibility feature to steal data and do actions and finally Malware developer used the Telegram bot to steal data.
<p align="center">
<img src="https://user-images.githubusercontent.com/36133745/164781804-83eed87e-8f79-44b7-b58d-3312abb78f02.png">
<img src="https://user-images.githubusercontent.com/36133745/164781814-de8428b9-6047-47eb-80f4-015fa9aa9908.png">
</p>
