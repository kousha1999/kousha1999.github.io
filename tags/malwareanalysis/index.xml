<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>MalwareAnalysis on Kousha Zanjani (INVOXES) Blog</title>
    <link>http://localhost:1313/tags/malwareanalysis/</link>
    <description>Recent content in MalwareAnalysis on Kousha Zanjani (INVOXES) Blog</description>
    <generator>Hugo</generator>
    <language>en</language>
    <managingEditor>Kousha.Zanjani@gmail.com (Kousha Zanjani)</managingEditor>
    <webMaster>Kousha.Zanjani@gmail.com (Kousha Zanjani)</webMaster>
    <copyright>Kousha Zanjani</copyright>
    <lastBuildDate>Wed, 04 May 2022 09:11:56 +0200</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/malwareanalysis/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Analyzing MSFVenom Android Payload (Malware)</title>
      <link>http://localhost:1313/posts/2022/msfvenom-android-malware-analysis/</link>
      <pubDate>Wed, 04 May 2022 09:11:56 +0200</pubDate><author>Kousha.Zanjani@gmail.com (Kousha Zanjani)</author>
      <guid>http://localhost:1313/posts/2022/msfvenom-android-malware-analysis/</guid>
      <description>&lt;p&gt;MSFVenom is one of the most popular frameworks to create payloads, shellcodes, etc. I want to analyze a little bit of MSFVenom Android payload. So&lt;/p&gt;&#xA;&lt;p align=&#34;center&#34;&gt;&#xA;&lt;img src=&#34;https://user-images.githubusercontent.com/36133745/164783235-d8df38a6-e0f3-4e68-9f64-57fa21b98435.gif&#34;&gt;&#xA;&lt;/p&gt;&#xA;&lt;h2 id=&#34;-part-1---creating-an-android-payload-with-msfvenom&#34;&gt;ðŸŽ¬ Part 1 - Creating an Android payload with MSFVenom&lt;/h2&gt;&#xA;&lt;p&gt;Run your Kali Linux distribution (I use vagrant kalilinux/rolling box) and open a terminal.&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Installing Kali Linux Box&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vagrant box add kalilinux/rolling&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Create a Kali Linux VM&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir -p /home/&lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;/Desktop/vagrantmachines/kali&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; /home/&lt;span class=&#34;nv&#34;&gt;$USER&lt;/span&gt;/Desktop/vagrantmachines/kali&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vagrant init kalilinux/rolling&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Set Kali Network to Bridge&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Add below line into Vagrantfile file below config.vm.box = &amp;#34;kalilinux/rolling&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  config.vm.network &lt;span class=&#34;s2&#34;&gt;&amp;#34;public_network&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Save and Exit from Vagrantfile&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Execute Kali Machine&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vagrant up&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# SSH to Kali Machine&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vagrant ssh&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# If you want to turn it off just execute the below command after you exit from SSH&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vagrant halt&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Simply execute the below command.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Android Trust Wallet Stealer Malware Analysis</title>
      <link>http://localhost:1313/posts/2022/android-trust-wallet-stealer-malware-analysis/</link>
      <pubDate>Sat, 23 Apr 2022 09:11:56 +0200</pubDate><author>Kousha.Zanjani@gmail.com (Kousha Zanjani)</author>
      <guid>http://localhost:1313/posts/2022/android-trust-wallet-stealer-malware-analysis/</guid>
      <description>&lt;p&gt;As far as technology improves, hackers do their best to abuse these technologies. Android became one of the most impressive technology and it&amp;rsquo;s going further. Hackers research Android Security every moment and Android malware spread more and more. There is a lot of malware that developed till today. I want to analyze an Android malware that is a Crypto Wallet Stealer.&lt;/p&gt;&#xA;&lt;p&gt;I have a sample which you can download it from &lt;a href=&#34;https://raw.githubusercontent.com/sk3ptre/AndroidMalware_2021/main/octCryptoStealer.zip&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HERE&lt;/a&gt;&#xA;. MD5 Checksum: 70b07a67b618a6352bf35a735645b156&lt;/p&gt;</description>
    </item>
    <item>
      <title>TeamTNT Miners in the Wild</title>
      <link>http://localhost:1313/posts/2021/teamtnt-miners-in-the-wild/</link>
      <pubDate>Wed, 22 Sep 2021 09:11:56 +0200</pubDate><author>Kousha.Zanjani@gmail.com (Kousha Zanjani)</author>
      <guid>http://localhost:1313/posts/2021/teamtnt-miners-in-the-wild/</guid>
      <description>&lt;p&gt;Last night my friend and I were Looking for some Redis NOSQL (Because Most of them do not have any authentication of course ðŸ˜†) in Shodan and Censys for Bug Hunting.&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;ve found some interesting things which led me to write this blog post.&lt;/p&gt;&#xA;&lt;p&gt;Most of the Redis seemed to be exploited and infected with a Miner by TeamTNT.&lt;/p&gt;&#xA;&lt;p&gt;I used shodan query &lt;code&gt;port:6379&lt;/code&gt; to find Redis services.&lt;div class=&#34;not-prose&#34;&gt;&#xA;&lt;figure&gt;&#xA;    &lt;img src=&#34;../../images/shodan.png&#34;&#xA;      alt=&#34;&#34; &#xA;      loading=&#34;lazy&#34;&#xA;    &gt;&#xA;  &lt;/figure&gt;&lt;/div&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;Redis has a tool called &lt;code&gt;redis-cli&lt;/code&gt; which lets you interact with Redis servers.&#xA;I used it to connect Redis servers to find vulnerabilities and sensitive data for bug hunting reports.&#xA;To connect a Redis server you can use &lt;code&gt;redis-cli -h [Redis Server IP]&lt;/code&gt;.&lt;div class=&#34;not-prose&#34;&gt;&#xA;&lt;figure&gt;&#xA;    &lt;img src=&#34;../../images/redis-cli-connection.png&#34;&#xA;      alt=&#34;&#34; &#xA;      loading=&#34;lazy&#34;&#xA;    &gt;&#xA;  &lt;/figure&gt;&lt;/div&gt;&#xA;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Lemon Duck Malware</title>
      <link>http://localhost:1313/posts/2021/lemon-duck-malware-analysis/</link>
      <pubDate>Mon, 24 May 2021 09:11:56 +0200</pubDate><author>Kousha.Zanjani@gmail.com (Kousha Zanjani)</author>
      <guid>http://localhost:1313/posts/2021/lemon-duck-malware-analysis/</guid>
      <description>&lt;p&gt;A month ago I&amp;rsquo;ve got a Log from a company (we will call it victim corp from now) that it was detected as a malicios activity. What I&amp;rsquo;ve got from that report log was just an URL, Funny right?! :))&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;ve start to google dork it. After some search and googling I&amp;rsquo;ve found some URLs and one of them was from &lt;code&gt;app.any.run&lt;/code&gt; website which is one of the best sandbox for malware analysis and downloading samples. It seem it&amp;rsquo;s already analyzed; however, I didn&amp;rsquo;t hesitate and I started analyzing.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Extract PNG Malware from PCAP File</title>
      <link>http://localhost:1313/posts/2021/extract-png-malware-from-pcap-file/</link>
      <pubDate>Thu, 13 May 2021 09:11:56 +0200</pubDate><author>Kousha.Zanjani@gmail.com (Kousha Zanjani)</author>
      <guid>http://localhost:1313/posts/2021/extract-png-malware-from-pcap-file/</guid>
      <description>&lt;p&gt;I want to talk about How I detected and extracted PNG malware from a PCAP file.&lt;/p&gt;&#xA;&lt;p&gt;What we will cover in this post:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Introduction to Packet Analysis&lt;/li&gt;&#xA;&lt;li&gt;Introduction to Wireshark&lt;/li&gt;&#xA;&lt;li&gt;Detect Malicious Network Traffic&lt;/li&gt;&#xA;&lt;li&gt;Partial Content Responses&lt;/li&gt;&#xA;&lt;li&gt;Impact of Connection Problems&lt;/li&gt;&#xA;&lt;li&gt;Extract Malicious File from HTTP for analysis and Reverse Engineering&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nowadays cyber attacks have become more sophisticated. The use of malware is increasing, Malware comes in many forms such as:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
